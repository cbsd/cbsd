cpu		HAMMER
ident		BHYVE

# Sync with the devices below? Have not needed virtio_blk etc.
makeoptions	MODULES_OVERRIDE="virtio"
#makeoptions	MODULES_OVERRIDE="virtio opensolaris zfs cryptodev acl_nfs4 xdr zlib crypto"

# Pick a scheduler - Required
options 	SCHED_ULE		# ULE scheduler
#options	SCHED_4BSD

device		pci
# The tribal elders say that the loopback device was not always required
device		loop			# Network loopback
# The modern kernel will not build without ethernet
device		ether			# Ethernet support
# The kernel should build at this point

# Was bhyve working without this?
device		acpi

# Do boot it in bhyve, you will want to see serial output
device		uart			# Generic UART driver

#panic: running without device atpic requires a local APIC
device		atpic			# 8259A compatability

# To get past mountroot
#device		ahci			# AHCI-compatible SATA controllers
#device		scbus			# SCSI bus (required for ATA/SCSI)

# Throws an error but works - Investigate
options		GEOM_PART_GPT		# GUID Partition Tables.

#Mounting from ufs:/dev/vtbd0p3 failed with error 2: unknown file system.
options 	FFS			# Berkeley Fast Filesystem

# Add labling handling to support booting from disc1.iso and memstick.img
options		GEOM_LABEL		# Provides labelization
# Add CD-ROM file system support for booting from disc1.iso
#device		cd			# CD
#options	CD9660			# ISO 9660 Filesystem

# Appears to work with only "virtio" synchronized above with MODULES_OVERRIDE
# Investigate
device		virtio			# Generic VirtIO bus (required)
device		virtio_pci		# VirtIO PCI device
device		virtio_blk		# VirtIO Block device

# Needed for Xen
#options		XENHVM			# Xen HVM kernel infrastructure
#device		xenpci			# Xen HVM Hypervisor services driver
#device		acpi
#device		da			# Direct Access (disks)

# Apparently not needed if virtio device and MODULE_OVERRIDE are specified
#device		vtnet			# VirtIO Ethernet device
#device		virtio_scsi		# VirtIO SCSI device
#device		virtio_balloon		# VirtIO Memory Balloon device

# Luxurious options - sync with build options
options	SMP			# Symmetric MultiProcessor Kernel

#  +25 MB RAM  ( 46MB total)
options	INET			# InterNETworking
#device		iflib
#device		em			# Intel PRO/1000 Gigabit Ethernet Family

# +20 MB RAM  (O_o, for console ?) ( 66 MB total )
# uncomment if you want to see console in UEFI boot
#device		vt
#device		vt_efifb

# Adding for cpersiva@/@cpersiva/wiki.freebsd.org/BootTime
# "Check out the freebsd-boot-profiling repo and run mkflame.sh"
#options		TSLOG

# ZFSROOT req:
#device	aesni		# AES-NI OpenCrypto module
#device	crypto		# core crypto support
